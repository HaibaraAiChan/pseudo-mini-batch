main start at this time 1649748832.9462087
-----------------------------------------before load data 
 Nvidia-smi: 1.1785888671875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

karate data
#nodes: 34
#edges: 156
#classes: 2
success----------------------------------------
24
5
5
# Nodes: 34
# Edges: 156
# Train: 24
# Val: 5
# Test: 5
# Classes: 2

in feats:  4
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0005083084106445312  GigaBytes
Max Memory Allocated: 0.0005083084106445312  GigaBytes

*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-
[Block(num_src_nodes=33, num_dst_nodes=33, num_edges=65), Block(num_src_nodes=33, num_dst_nodes=30, num_edges=78), Block(num_src_nodes=30, num_dst_nodes=24, num_edges=70)]
global src and dst nids
tensor([18,  9,  2,  8, 20, 19, 14,  5,  0, 15, 21,  7, 12, 22, 11, 23, 16, 13,
        17,  1,  3, 10,  6,  4, 32, 33, 30, 25, 29, 27, 24, 31, 26])
tensor([18,  9,  2,  8, 20, 19, 14,  5,  0, 15, 21,  7, 12, 22, 11, 23, 16, 13,
        17,  1,  3, 10,  6,  4, 32, 33, 30, 25, 29, 27, 24, 31, 26])
global src and dst nids
tensor([18,  9,  2,  8, 20, 19, 14,  5,  0, 15, 21,  7, 12, 22, 11, 23, 16, 13,
        17,  1,  3, 10,  6,  4, 32, 33, 30, 25, 29, 27, 24, 31, 26])
tensor([18,  9,  2,  8, 20, 19, 14,  5,  0, 15, 21,  7, 12, 22, 11, 23, 16, 13,
        17,  1,  3, 10,  6,  4, 32, 33, 30, 25, 29, 27])
global src and dst nids
tensor([18,  9,  2,  8, 20, 19, 14,  5,  0, 15, 21,  7, 12, 22, 11, 23, 16, 13,
        17,  1,  3, 10,  6,  4, 32, 33, 30, 25, 29, 27])
tensor([18,  9,  2,  8, 20, 19, 14,  5,  0, 15, 21,  7, 12, 22, 11, 23, 16, 13,
        17,  1,  3, 10,  6,  4])
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002266407012939453
src global
[18, 9, 2, 8, 20, 19, 14, 5, 0, 15, 21, 7, 12, 22, 11, 23, 16, 13, 17, 1, 3, 10, 6, 4, 32, 33, 30, 25, 29, 27]
dst local
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
global_2_local spend time (sec) 6.914138793945312e-05
----------------------------  graph partition start---------------------
  (1, 1)	1
  (8, 1)	1
  (17, 1)	1
  (24, 1)	1
  (2, 2)	3
  (3, 2)	1
  (8, 2)	1
  (17, 2)	1
  (19, 2)	2
  (25, 2)	2
  (2, 3)	1
  (3, 3)	1
  (17, 3)	1
  (19, 3)	1
  (2, 5)	2
  (3, 5)	1
  (8, 5)	1
  (11, 5)	1
  (17, 5)	1
  (19, 5)	1
  (26, 5)	1
  (2, 7)	1
  (3, 7)	1
  (7, 7)	3
  (8, 7)	2
  :	:
  (2, 21)	1
  (3, 21)	1
  (8, 21)	2
  (16, 21)	1
  (17, 21)	1
  (19, 21)	1
  (21, 21)	2
  (22, 21)	2
  (2, 22)	1
  (3, 22)	1
  (7, 22)	1
  (8, 22)	2
  (16, 22)	1
  (17, 22)	1
  (19, 22)	1
  (21, 22)	2
  (22, 22)	3
  (2, 23)	1
  (3, 23)	1
  (7, 23)	2
  (8, 23)	2
  (16, 23)	1
  (17, 23)	1
  (19, 23)	1
  (23, 23)	2
     source  target  weight  capacity
0         1       1       1         1
1         8       1       1         1
2        17       1       1         1
3         2       2       3         3
4         3       2       1         1
..      ...     ...     ...       ...
111       8      23       2         2
112      16      23       1         1
113      17      23       1         1
114      19      23       1         1
115      23      23       2         2

[116 rows x 4 columns]

4
({1}, {2, 3, 5, 7, 8, 10, 11, 12, 14, 16, 17, 18, 19, 20, 21, 22, 23})
after graph partition
graph partition algorithm spend time 0.03523373603820801
partition_len_list
[3, 21]
shared_neighbor_graph_partition selection method range initialization spend 0.035536766052246094
time for parepare:  8.106231689453125e-06
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.0001270771026611328
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.0008151531219482422
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001513957977294922
mini_batch_src_global generation:  2.4080276489257812e-05
r_  generation:  4.458427429199219e-05
----------------------check_connections_block total spend ----------------------------- 0.0013623237609863281
generate_one_block  0.0029816627502441406
generate_one_block  0.0013594627380371094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005004405975341797
gen group dst list time:  2.0503997802734375e-05
time for parepare:  1.33514404296875e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  2.2172927856445312e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  4.1484832763671875e-05
----------------------check_connections_block total spend ----------------------------- 0.0005273818969726562
generate_one_block  0.0012772083282470703
generate_one_block  0.0013208389282226562
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.00047779083251953125
gen group dst list time:  1.9788742065429688e-05
time for parepare:  9.775161743164062e-06
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  2.5510787963867188e-05
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.5762786865234375e-05
----------------------check_connections_block total spend ----------------------------- 0.0005292892456054688
generate_one_block  0.0012850761413574219
generate_one_block  0.0014009475708007812
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.0005083084106445312  GigaBytes
Max Memory Allocated: 0.0005083084106445312  GigaBytes

connection checking time:  0.001056671142578125
block generation total time  0.00528407096862793
average batch blocks generation time:  0.002642035484313965
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0887451171875 GB
    Memory Allocated: 0.0005121231079101562  GigaBytes
Max Memory Allocated: 0.0005121231079101562  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.0887451171875 GB
    Memory Allocated: 0.0005121231079101562  GigaBytes
Max Memory Allocated: 0.0005121231079101562  GigaBytes

torch.Size([15, 4])
----------------------------------------after rst
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0005292892456054688  GigaBytes
Max Memory Allocated: 0.0005369186401367188  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0005216598510742188  GigaBytes
Max Memory Allocated: 0.0005369186401367188  GigaBytes

torch.Size([8, 256])
input nodes number: 15
output nodes number: 8
edges number: 16
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0005321502685546875  GigaBytes
Max Memory Allocated: 0.0005369186401367188  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0005397796630859375  GigaBytes
Max Memory Allocated: 0.0005397796630859375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.00054168701171875  GigaBytes
Max Memory Allocated: 0.00054931640625  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.00054168701171875  GigaBytes
Max Memory Allocated: 0.00054931640625  GigaBytes

torch.Size([8, 256])
----------------------------------------after rst
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0005521774291992188  GigaBytes
Max Memory Allocated: 0.0005550384521484375  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.00054931640625  GigaBytes
Max Memory Allocated: 0.0005550384521484375  GigaBytes

torch.Size([3, 256])
input nodes number: 8
output nodes number: 3
edges number: 8
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0005550384521484375  GigaBytes
Max Memory Allocated: 0.0005550384521484375  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0005578994750976562  GigaBytes
Max Memory Allocated: 0.0005578994750976562  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0005588531494140625  GigaBytes
Max Memory Allocated: 0.0005617141723632812  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0005626678466796875  GigaBytes
Max Memory Allocated: 0.0005631446838378906  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0005621910095214844  GigaBytes
Max Memory Allocated: 0.0005631446838378906  GigaBytes

torch.Size([1, 2])
input nodes number: 3
output nodes number: 1
edges number: 2
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0005636215209960938  GigaBytes
Max Memory Allocated: 0.0005636215209960938  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0010170936584472656  GigaBytes
Max Memory Allocated: 0.0010600090026855469  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0010170936584472656  GigaBytes
Max Memory Allocated: 0.0010600090026855469  GigaBytes

torch.Size([28, 4])
----------------------------------------after rst
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0010628700256347656  GigaBytes
Max Memory Allocated: 0.0010848045349121094  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0010409355163574219  GigaBytes
Max Memory Allocated: 0.0010848045349121094  GigaBytes

torch.Size([23, 256])
input nodes number: 28
output nodes number: 23
edges number: 45
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0010657310485839844  GigaBytes
Max Memory Allocated: 0.0010848045349121094  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0010876655578613281  GigaBytes
Max Memory Allocated: 0.0010876655578613281  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0010933876037597656  GigaBytes
Max Memory Allocated: 0.0011153221130371094  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0010933876037597656  GigaBytes
Max Memory Allocated: 0.0011153221130371094  GigaBytes

torch.Size([23, 256])
----------------------------------------after rst
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0011553764343261719  GigaBytes
Max Memory Allocated: 0.0011754035949707031  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0011353492736816406  GigaBytes
Max Memory Allocated: 0.0011754035949707031  GigaBytes

torch.Size([21, 256])
input nodes number: 23
output nodes number: 21
edges number: 56
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0011582374572753906  GigaBytes
Max Memory Allocated: 0.0011754035949707031  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0011782646179199219  GigaBytes
Max Memory Allocated: 0.0011782646179199219  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0011835098266601562  GigaBytes
Max Memory Allocated: 0.0012035369873046875  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0012025833129882812  GigaBytes
Max Memory Allocated: 0.0012178421020507812  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0012021064758300781  GigaBytes
Max Memory Allocated: 0.0012178421020507812  GigaBytes

torch.Size([17, 2])
input nodes number: 21
output nodes number: 17
edges number: 54
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2489013671875 GB
    Memory Allocated: 0.0012030601501464844  GigaBytes
Max Memory Allocated: 0.0012178421020507812  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00022602081298828125 |0.19812774658203125 |0.43376433849334717 |0.00015747547149658203 |0.004659891128540039 |0.0028688907623291016 |
----------------------------------------------------------pseudo_mini_loss sum 1.5489943027496338
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  98
Number of first layer input nodes during this epoch:  43
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.002033710479736328  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-
[Block(num_src_nodes=33, num_dst_nodes=31, num_edges=61), Block(num_src_nodes=31, num_dst_nodes=29, num_edges=75), Block(num_src_nodes=29, num_dst_nodes=24, num_edges=70)]
global src and dst nids
tensor([11, 12,  3, 16, 15,  4,  6,  7,  9, 10, 21, 22, 19,  1, 17, 14,  5, 23,
        20,  2, 18,  0,  8, 13, 32, 33, 27, 29, 30, 25, 24, 31, 26])
tensor([11, 12,  3, 16, 15,  4,  6,  7,  9, 10, 21, 22, 19,  1, 17, 14,  5, 23,
        20,  2, 18,  0,  8, 13, 32, 33, 27, 29, 30, 25, 24])
global src and dst nids
tensor([11, 12,  3, 16, 15,  4,  6,  7,  9, 10, 21, 22, 19,  1, 17, 14,  5, 23,
        20,  2, 18,  0,  8, 13, 32, 33, 27, 29, 30, 25, 24])
tensor([11, 12,  3, 16, 15,  4,  6,  7,  9, 10, 21, 22, 19,  1, 17, 14,  5, 23,
        20,  2, 18,  0,  8, 13, 32, 33, 27, 29, 30])
global src and dst nids
tensor([11, 12,  3, 16, 15,  4,  6,  7,  9, 10, 21, 22, 19,  1, 17, 14,  5, 23,
        20,  2, 18,  0,  8, 13, 32, 33, 27, 29, 30])
tensor([11, 12,  3, 16, 15,  4,  6,  7,  9, 10, 21, 22, 19,  1, 17, 14,  5, 23,
        20,  2, 18,  0,  8, 13])
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.002850770950317383
src global
[11, 12, 3, 16, 15, 4, 6, 7, 9, 10, 21, 22, 19, 1, 17, 14, 5, 23, 20, 2, 18, 0, 8, 13, 32, 33, 27, 29, 30]
dst local
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
global_2_local spend time (sec) 8.535385131835938e-05
----------------------------  graph partition start---------------------
  (14, 0)	1
  (16, 0)	1
  (22, 0)	1
  (23, 0)	1
  (1, 1)	1
  (7, 1)	1
  (14, 1)	1
  (16, 1)	1
  (21, 1)	1
  (22, 1)	1
  (23, 1)	2
  (2, 2)	3
  (13, 2)	2
  (14, 2)	1
  (16, 2)	1
  (19, 2)	1
  (21, 2)	3
  (22, 2)	1
  (23, 2)	1
  (25, 2)	1
  (3, 3)	2
  (5, 3)	1
  (6, 3)	1
  (9, 3)	1
  (16, 3)	1
  :	:
  (2, 21)	1
  (3, 21)	1
  (6, 21)	1
  (9, 21)	1
  (13, 21)	2
  (19, 21)	1
  (21, 21)	4
  (25, 21)	2
  (28, 21)	1
  (7, 22)	1
  (8, 22)	1
  (14, 22)	1
  (16, 22)	1
  (22, 22)	2
  (23, 22)	1
  (26, 22)	1
  (1, 23)	1
  (7, 23)	1
  (10, 23)	1
  (14, 23)	2
  (16, 23)	1
  (19, 23)	1
  (21, 23)	1
  (22, 23)	1
  (23, 23)	3
     source  target  weight  capacity
0        14       0       1         1
1        16       0       1         1
2        22       0       1         1
3        23       0       1         1
4         1       1       1         1
..      ...     ...     ...       ...
114      16      23       1         1
115      19      23       1         1
116      21      23       1         1
117      22      23       1         1
118      23      23       3         3

[119 rows x 4 columns]

4
({0}, {1, 2, 3, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 19, 21, 22, 23})
after graph partition
graph partition algorithm spend time 0.023052215576171875
partition_len_list
[2, 20]
shared_neighbor_graph_partition selection method range initialization spend 0.023406982421875
time for parepare:  7.3909759521484375e-06
local_output_nid generation:  3.5762786865234375e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  3.9577484130859375e-05
r_  generation:  3.719329833984375e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  4.57763671875e-05
----------------------check_connections_block total spend ----------------------------- 0.0005745887756347656
generate_one_block  0.003215312957763672
generate_one_block  0.0015141963958740234
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005462169647216797
gen group dst list time:  2.0742416381835938e-05
time for parepare:  1.1682510375976562e-05
local_output_nid generation:  1.9073486328125e-06
local_in_edges_tensor generation:  0.00019073486328125
mini_batch_src_global generation:  2.4557113647460938e-05
r_  generation:  2.0503997802734375e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00011467933654785156
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.743171691894531e-05
----------------------check_connections_block total spend ----------------------------- 0.0005300045013427734
generate_one_block  0.0012753009796142578
generate_one_block  0.0013248920440673828
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0004429817199707031
gen group dst list time:  2.0503997802734375e-05
time for parepare:  1.049041748046875e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00018143653869628906
mini_batch_src_global generation:  2.3365020751953125e-05
r_  generation:  2.2649765014648438e-05
local_output_nid generation:  3.0994415283203125e-06
local_in_edges_tensor generation:  0.00010967254638671875
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  3.4332275390625e-05
----------------------check_connections_block total spend ----------------------------- 0.0005071163177490234
generate_one_block  0.0012531280517578125
generate_one_block  0.0012853145599365234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.002033710479736328  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

connection checking time:  0.0010371208190917969
block generation total time  0.0051386356353759766
average batch blocks generation time:  0.0025693178176879883
block dataloader generation time/epoch 1.0607128143310547
----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0020232200622558594  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0020232200622558594  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

torch.Size([10, 4])
----------------------------------------after rst
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0020346641540527344  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.002029895782470703  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

torch.Size([5, 256])
input nodes number: 10
output nodes number: 5
edges number: 9
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.002037525177001953  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0020422935485839844  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0020437240600585938  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0020437240600585938  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

torch.Size([5, 256])
----------------------------------------after rst
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0020513534545898438  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0020494461059570312  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

torch.Size([2, 256])
input nodes number: 5
output nodes number: 2
edges number: 4
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0020542144775390625  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.002056121826171875  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.002056598663330078  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.002060413360595703  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0020599365234375  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

torch.Size([1, 2])
input nodes number: 2
output nodes number: 1
edges number: 1
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0020608901977539062  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0020241737365722656  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0020241737365722656  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

torch.Size([25, 4])
----------------------------------------after rst
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0020699501037597656  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.002048015594482422  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

torch.Size([23, 256])
input nodes number: 25
output nodes number: 23
edges number: 46
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0020728111267089844  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.002094745635986328  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0021004676818847656  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------before model layer 1
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0021004676818847656  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

torch.Size([23, 256])
----------------------------------------after rst
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.002159595489501953  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.002140522003173828  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

torch.Size([20, 256])
input nodes number: 23
output nodes number: 20
edges number: 55
----------------------------------------after model layer 1 x = self.bns[i](x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.002162456512451172  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.002181529998779297  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.002186298370361328  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.002205371856689453  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.00220489501953125  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

torch.Size([17, 2])
input nodes number: 20
output nodes number: 17
edges number: 55
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2508544921875 GB
    Memory Allocated: 0.0022058486938476562  GigaBytes
Max Memory Allocated: 0.0027666091918945312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00024449825286865234 |0.00047016143798828125 |0.010572075843811035 |0.00010991096496582031 |0.0029860734939575195 |0.00222015380859375 |
----------------------------------------------------------pseudo_mini_loss sum 0.2566783130168915
Total (block generation + training)time/epoch 1.0944790840148926
Training time/epoch 0.033574581146240234
Training time without block to device /epoch 0.03263425827026367
Training time without total dataloading part /epoch 0.0295562744140625
load block tensor time/epoch 0.0004889965057373047
block to device time/epoch 0.0009403228759765625
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  85
Number of first layer input nodes during this epoch:  35
