main start at this time 1646717704.4588444
#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3569016456604004
range selection method range initialization spend 0.03022289276123047
time for parepare:  0.2698643207550049
local_output_nid generation:  0.025554895401000977
local_in_edges_tensor generation:  0.0859975814819336
mini_batch_src_global generation:  0.11615705490112305
r_  generation:  1.8083338737487793
local_output_nid generation:  0.028123140335083008
local_in_edges_tensor generation:  0.06421828269958496
mini_batch_src_global generation:  0.14311552047729492
r_  generation:  1.9999749660491943
----------------------check_connections_block total spend ----------------------------- 5.130099534988403
generate_one_block  7.44961404800415
generate_one_block  2.3844428062438965
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.3047733306884766
gen group dst list time:  0.06389021873474121
time for parepare:  0.41696810722351074
local_output_nid generation:  0.16934680938720703
local_in_edges_tensor generation:  0.8540263175964355
mini_batch_src_global generation:  1.0145189762115479
r_  generation:  13.827646970748901
local_output_nid generation:  0.3338282108306885
local_in_edges_tensor generation:  0.8308112621307373
mini_batch_src_global generation:  1.2722737789154053
r_  generation:  14.57545256614685
----------------------check_connections_block total spend ----------------------------- 37.89116334915161
generate_one_block  18.819432973861694
generate_one_block  19.083326816558838
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.169783115386963
gen group dst list time:  0.15242600440979004
time for parepare:  0.45314669609069824
local_output_nid generation:  0.3556478023529053
local_in_edges_tensor generation:  1.0324561595916748
mini_batch_src_global generation:  1.2133662700653076
r_  generation:  17.616388082504272
local_output_nid generation:  0.643446683883667
local_in_edges_tensor generation:  1.2104368209838867
mini_batch_src_global generation:  1.6701200008392334
r_  generation:  18.8119797706604
----------------------check_connections_block total spend ----------------------------- 49.351178884506226
generate_one_block  23.878012895584106
generate_one_block  23.525156021118164
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0242919921875 GB
    Memory Allocated: 0.00010251998901367188  GigaBytes
Max Memory Allocated: 0.00010251998901367188  GigaBytes

connection checking time:  87.24234223365784
block generation total time  85.3059287071228
average batch blocks generation time:  42.6529643535614
for loop block_dataloader item  time:  1.9311904907226562e-05
for loop block_dataloader item  time:  0.00013256072998046875
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3174571990966797 |0.9179931879043579 |0.3947427272796631 |0.00014448165893554688 |0.08403134346008301 |0.0021355152130126953 |
----------------------------------------------------------pseudo_mini_loss sum 8.818731307983398
 Run 0| Epoch 0 |
Number of nodes during this epoch:  4499029
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.1375732421875 GB
    Memory Allocated: 2.598694324493408  GigaBytes
Max Memory Allocated: 4.528625965118408  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4308621883392334
range selection method range initialization spend 0.02893543243408203
time for parepare:  0.2812662124633789
local_output_nid generation:  0.025336027145385742
local_in_edges_tensor generation:  0.08563923835754395
mini_batch_src_global generation:  0.11873054504394531
r_  generation:  1.845672607421875
local_output_nid generation:  0.02846980094909668
local_in_edges_tensor generation:  0.06456923484802246
mini_batch_src_global generation:  0.14956068992614746
r_  generation:  1.9417221546173096
----------------------check_connections_block total spend ----------------------------- 5.1573755741119385
generate_one_block  2.8090035915374756
generate_one_block  2.391669511795044
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.9942364692687988
gen group dst list time:  0.060861825942993164
time for parepare:  0.4231274127960205
local_output_nid generation:  0.1691734790802002
local_in_edges_tensor generation:  0.723665714263916
mini_batch_src_global generation:  1.0497145652770996
r_  generation:  14.045785427093506
local_output_nid generation:  0.32739996910095215
local_in_edges_tensor generation:  0.957535982131958
mini_batch_src_global generation:  1.314939022064209
r_  generation:  14.481897592544556
----------------------check_connections_block total spend ----------------------------- 38.277217626571655
generate_one_block  19.17841601371765
generate_one_block  19.193425178527832
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.241048812866211
gen group dst list time:  0.15230464935302734
time for parepare:  0.4565105438232422
local_output_nid generation:  0.35157012939453125
local_in_edges_tensor generation:  1.0264129638671875
mini_batch_src_global generation:  1.216503381729126
r_  generation:  17.86850094795227
local_output_nid generation:  0.5904428958892822
local_in_edges_tensor generation:  1.3309340476989746
mini_batch_src_global generation:  1.631847858428955
r_  generation:  18.021703481674194
----------------------check_connections_block total spend ----------------------------- 48.57991671562195
generate_one_block  23.413521766662598
generate_one_block  23.897831678390503
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.1375732421875 GB
    Memory Allocated: 2.598694324493408  GigaBytes
Max Memory Allocated: 4.528625965118408  GigaBytes

connection checking time:  86.8571343421936
block generation total time  85.68319463729858
average batch blocks generation time:  42.84159731864929
block dataloader generation time/epoch 199.75293064117432
for loop block_dataloader item  time:  0.01841592788696289
for loop block_dataloader item  time:  0.00016880035400390625
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4006495475769043 |0.6852492094039917 |0.004465937614440918 |0.00010406970977783203 |0.005196928977966309 |0.002894163131713867 |
----------------------------------------------------------pseudo_mini_loss sum 5.132653713226318
Total (block generation + training)time/epoch 202.17493605613708
Training 1 time/epoch 2.4220051765441895
Training time/epoch 2.4218292236328125
 Run 0| Epoch 1 |
Number of nodes during this epoch:  4498642
----------------------------------------before generate_dataloader_block 
 Nvidia-smi: 10.1375732421875 GB
    Memory Allocated: 2.599801540374756  GigaBytes
Max Memory Allocated: 4.531242847442627  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.43140268325805664
range selection method range initialization spend 0.030300140380859375
time for parepare:  0.289780855178833
local_output_nid generation:  0.024448394775390625
local_in_edges_tensor generation:  0.06075572967529297
mini_batch_src_global generation:  0.11280083656311035
r_  generation:  1.9073195457458496
local_output_nid generation:  0.02906632423400879
local_in_edges_tensor generation:  0.04845690727233887
mini_batch_src_global generation:  0.14272093772888184
r_  generation:  1.958998441696167
----------------------check_connections_block total spend ----------------------------- 5.220273971557617
generate_one_block  2.845111846923828
generate_one_block  2.763946294784546
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1114535331726074
gen group dst list time:  0.06975317001342773
time for parepare:  0.45203208923339844
local_output_nid generation:  0.18975496292114258
local_in_edges_tensor generation:  0.7637977600097656
mini_batch_src_global generation:  1.0362772941589355
r_  generation:  14.348953485488892
local_output_nid generation:  0.34905004501342773
local_in_edges_tensor generation:  1.1043810844421387
mini_batch_src_global generation:  1.3581054210662842
r_  generation:  14.478084087371826
----------------------check_connections_block total spend ----------------------------- 39.00691318511963
generate_one_block  19.12934684753418
generate_one_block  19.09368133544922
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2061238288879395
gen group dst list time:  0.1529097557067871
time for parepare:  0.434434175491333
local_output_nid generation:  0.3783438205718994
local_in_edges_tensor generation:  1.0351228713989258
mini_batch_src_global generation:  1.2192583084106445
r_  generation:  18.2622549533844
local_output_nid generation:  0.6516396999359131
local_in_edges_tensor generation:  1.4693973064422607
mini_batch_src_global generation:  1.7545995712280273
r_  generation:  18.447309970855713
----------------------check_connections_block total spend ----------------------------- 49.92142581939697
generate_one_block  23.661442756652832
generate_one_block  23.55301260948181
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.1375732421875 GB
    Memory Allocated: 2.599801540374756  GigaBytes
Max Memory Allocated: 4.531242847442627  GigaBytes

connection checking time:  88.9283390045166
block generation total time  85.43748354911804
average batch blocks generation time:  42.71874177455902
block dataloader generation time/epoch 201.03813314437866
for loop block_dataloader item  time:  0.023885250091552734
for loop block_dataloader item  time:  0.00017452239990234375
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.42326509952545166 |0.5647830963134766 |0.01385641098022461 |9.465217590332031e-05 |0.09048354625701904 |0.0028448104858398438 |
----------------------------------------------------------pseudo_mini_loss sum 3.725958824157715
Total (block generation + training)time/epoch 203.3737771511078
Training 1 time/epoch 2.2492825984954834
Training time/epoch 2.249136447906494
 Run 0| Epoch 2 |
Number of nodes during this epoch:  4500239
